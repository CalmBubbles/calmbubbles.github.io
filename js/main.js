window.onload=()=>{Loop.Init(),Data.Init()},window.addEventListener("pageshow",(t=>{t.persisted&&window.location.reload()}));class Data{static#t=!1;static#e=[];static#a=null;static#i=null;static menuList=[];static socials={};static html={body:null,main:null};static get isLoaded(){return this.#t}static get currentEvent(){return this.#i}static#n(t,e,a){const i=this.#e.find((a=>a.event===t&&a.callback===e));if(null==i)return void this.#e.push({event:t,callback:e,recallable:a});const n=this.#e.indexOf(i);this.#e.splice(n,1)}static GetCurrentPage(){if(null!=this.#a)return this.#a;const t=window.location.toString().split("/"),e=window.location.search.length+window.location.hash.length;let a=t.length;0!==e&&(t[a-1]=t[a-1].slice(0,-e)),t[a-1].endsWith(".html")&&(t[a-1]=t[a-1].slice(0,-5)),["index",""].includes(t[a-1])&&a--;let i="";for(let e=0;e<a;e++)i+=t[e],(e<a-1||a<4)&&(i+="/");return this.#a=i,i}static On(t,e){this.#n(t,e,!0)}static Once(t,e){this.#n(t,e,!1)}static async#s(t){this.#i=t;const e=this.#e.filter((e=>e.event===t));for(let t=0;t<e.length;t++)await e[t].callback(),e[t].recallable||this.#e.splice(this.#e.indexOf(e[t]),1);this.#i=null}static async Image(t){const e=await fetch(t),a=await e.blob();return await URL.createObjectURL(a)}static async Init(){if(this.#t)return;this.html.body=document.body,this.html.main=document.querySelector("main"),await this.#s("WhileDataLoading");const t=await fetch("/data/data.json"),e=await t.json(),a=e.menus[parseInt(document.body.getAttribute("data-site")??0)-1];if(null==a)this.menuList=e.menuList;else if(a.endsWith(".json")){const t=await fetch(`/data/${a}`);this.menuList=await t.json()}else{const t=await fetch(`/data/${a}/data.json`),e=await t.json(),i=await fetch(`/data/${a}/${e[parseInt(document.body.getAttribute("data-menu")??0)]}.json`);this.menuList=await i.json()}this.socials=e.socials,this.#t=!0,await new Promise((t=>requestAnimationFrame(t))),await this.#s("OnDataLoad")}}class Loop{static#t=!1;static#l=0;static#o=0;static#c=0;static#r=0;static#d=0;static#h=[];static targetFrameRate=-1;static vSyncCount=1;static timeScale=1;static maximumDeltaTime=.06666667;static get frameCount(){return this.#l}static get unscaledTime(){return this.#o}static get unscaledDeltaTime(){return this.#c}static get time(){return this.#r}static get deltaTime(){return this.#d}static#m(){0===this.targetFrameRate||1===this.vSyncCount?requestAnimationFrame(this.#u.bind(this)):2===this.vSyncCount?requestAnimationFrame((()=>requestAnimationFrame(this.#u.bind(this)))):setTimeout(this.#u.bind(this),0)}static#p(){this.#c=.001*performance.now()-this.#o,this.#o+=this.#c;let t=this.#c;t>this.maximumDeltaTime&&(t=this.maximumDeltaTime),this.#d=t*this.timeScale,this.#r+=this.#d,this.#g(),0!==this.timeScale&&this.#l++}static#u(){if(this.targetFrameRate>0&&0===this.vSyncCount){const t=1/this.targetFrameRate-.005;let e=.001*performance.now()-this.#o;for(;e>=t;)this.#p(),e-=t}else this.#p();this.#m()}static#g(){for(let t=0;t<this.#h.length;t++){const e=this.#h[t];e.time+=this.#d,e.time<=e.timeout||(e.callback(),e.clear()?this.#h.splice(this.#h.indexOf(e),1):e.time=0)}}static Init(){this.#t||(this.#t=!0,this.#m())}static Append(t,e,a){this.#h.push({callback:t,clear:a??(()=>!1),timeout:e??0,time:0})}static async Delay(t){if(0===t)return;let e=!1;return new Promise((a=>this.Append((()=>{e=!0,a()}),t,(()=>e))))}}class Menu{static#t=!1;static#w=!1;static#y=[];static#f=null;static#b=null;static#v=null;static get isEnabled(){return this.#w}static async Set(){if(this.#t)return;this.#f=document.createElement("div"),this.#b=document.createElement("hr");const t=document.createElement("div"),e=[document.createElement("a"),document.createElement("a"),document.createElement("a")],a=[document.createElement("img"),document.createElement("img"),document.createElement("img")];this.#f.id="menu",t.id="menuSocials",e[0].href=Data.socials.youtube,e[1].href=Data.socials.twitter,e[2].href=Data.socials.instagram,a[0].id="menuBtnYt",a[1].id="menuBtnTwt",a[2].id="menuBtnInsta";const i=await Data.Image("/img/socials.png");for(let n=0;n<3;n++)e[n].target="_blank",a[n].classList.add("unselectable"),a[n].src=i,e[n].append(a[n]),t.append(e[n]);this.#b.id="menuOverlay";const n=document.createElement("div");n.id="menuNav";const s=await Data.Image("/img/menuDropdown.png");for(let t=0;t<Data.menuList.length;t++){const e=Data.menuList[t];if(Array.isArray(e.content)){if(0===e.content.length)continue;const t=document.createElement("div"),a=document.createElement("div");this.#y.push(new MenuDropdown(t,a,e,s)),n.append(t,a);continue}const a=document.createElement("a"),i=document.createElement("div");a.href=e.content??"/coming-soon",null!=e.content&&a.href===Data.GetCurrentPage()&&a.classList.add("currentPage"),i.classList.add("menuList"),i.append(e.name),a.append(i),n.append(a)}this.#f.append(n,t);Data.html.body.querySelector("#menuSection").append(this.#f,this.#b);const l=document.querySelector("#btnMenu");this.#v=l.querySelector("img"),this.#t=!0,this.#b.onclick=()=>this.Toggle(),l.onclick=()=>this.Toggle()}static async Toggle(t){if(!this.#t)return;this.#w=!this.#w;const e=(this.#w?.5:.25)*+!t,a=e/Loop.timeScale;if(Data.html.body.setAttribute("data-scrollable",this.#w?"menu":"true"),!this.#w)for(let t=0;t<this.#y.length;t++)this.#y[t].isEnabled&&!this.#y[t].currentPage&&this.#y[t].Toggle();this.#v.style.transition=`transform steps(6) ${a}s`,this.#f.style.transition=`transform ${a}s`,this.#b.style.transition=`opacity ${a}s`,Data.html.main.style.transition=`max-width ${a}s, transform ${a}s`,await Loop.Delay(e),this.#v.style.transition="initial",this.#f.style.transition="initial",this.#b.style.transition="initial",Data.html.main.style.transition="initial"}}class MenuDropdown{#w=!1;#D=0;#E=null;#L=null;currentPage=!1;get isEnabled(){return this.#w}constructor(t,e,a,i){this.#E=e,t.classList.add("menuList");const n=document.createElement("span"),s=document.createElement("div");this.#L=document.createElement("img"),n.append(a.name),this.#L.classList.add("unselectable"),this.#L.src=i,this.#L.alt=a.name,s.append(this.#L),t.append(n,s),this.#E.classList.add("menuDropdown");for(let t=0;t<a.content.length;t++){const e=document.createElement("a"),i=document.createElement("div");let n=null,s=null;if("string"==typeof a.content[t])n=`${a.dir??""}${a.content[t]}`,s=a.content[t];else{const e=a.content[t].link;null!=e&&(n=`${a.dir??""}${e}`),s=a.content[t].name}e.href=n??"/coming-soon",null!=n&&e.href===Data.GetCurrentPage()&&(e.classList.add("currentPage"),this.currentPage=!0),i.classList.add("menuSubList"),i.append(s),e.append(i),this.#E.append(e)}requestAnimationFrame((()=>{this.#D=this.#E.scrollHeight,t.onclick=()=>this.Toggle(),this.currentPage&&this.Toggle(!0)}))}async Toggle(t){this.#w=!this.#w;const e=(this.#w?.25:.125)*+!t,a=e/Loop.timeScale;this.#w?(this.#L.style.transform="translateX(calc(-225.882352941 * var(--pixel-unit)))",this.#E.style.maxHeight=`${this.#D}px`):(this.#L.style.transform="none",this.#E.style.maxHeight="0"),this.#L.style.transition=`transform steps(4) ${a}s`,this.#E.style.transition=`max-height ${a}s`,await Loop.Delay(e),this.#L.style.transition="none",this.#E.style.transition="none"}}class ScreenTrans{static#t=!1;static#T=null;static ScanAnchors(){const t=document.querySelectorAll("a:not([target='_blank'])");for(let e=0;e<t.length;e++){let a=!0;for(let i=0;i<t[e].href.length;i++)"#"===t[e].href[i]&&(a=!1);if(!a)return;t[e].onclick=async a=>{a.preventDefault();const i=t[e].href;this.#T.style.pointerEvents="initial",this.#T.style.opacity="1",this.#T.style.transition=`opacity ${.25/Loop.timeScale}s`,await Loop.Delay(.25),window.location.href=i}}}static async Set(){this.#t||(this.#T=document.querySelector(".fadeObject"),this.#T.style.opacity="0",this.#T.style.transition=`opacity ${.25/Loop.timeScale}s`,await Loop.Delay(.25),this.#T.style.pointerEvents="none",this.#T.style.transition="initial",(1===parseInt(document.body.getAttribute("hide-menu"))||window.innerWidth<1025)&&Data.html.body.setAttribute("data-scrollable","true"),this.#t=!0,this.ScanAnchors(),Loop.Append((()=>this.ScanAnchors()),.5))}}Data.Once("WhileDataLoading",(()=>{})),Data.Once("OnDataLoad",(async()=>{await Menu.Set(),1!==parseInt(document.body.getAttribute("hide-menu"))&&window.innerWidth>1024&&(await Menu.Toggle(!0),requestAnimationFrame((()=>{const t=document.querySelector("#menu .currentPage");null!=t&&(t.style.outline="0",t.focus())}))),ScreenTrans.Set()}));